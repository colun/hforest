# HilbertForest

HilbertForestは、ヒルベルト曲線を用いた近似k近傍探索ライブラリです。

## 特徴

- ヒルベルト曲線による空間索引構築
- k近傍探索に対応
- C++実装によるPythonライブラリ

## インストール

### 必要要件

- Python 3.7以上
- g++ (C++14対応)

### ビルド

```bash
git clone https://github.com/colun/hforest.git
cd hforest
make
```

## 想定されるデータ形式

このライブラリは以下のいずれかの形式のデータに対して最適化されています：

1. **単位ベクトル**: 各ベクトルのL2ノルムが1に正規化されたデータ
2. **正規化されたガウス分布**: 各座標値が平均0、標準偏差が`1/√d`（dは次元数）のガウス分布に従うデータ

これらの条件から大きく外れるデータの場合、性能が低下する可能性があります。

## 主要なパラメータ

### コンストラクタパラメータ

- `db_path` (str, default="db"): インデックスファイルの保存先ディレクトリ
- `ntrees` (int, default=10): 構築する木の数（精度と速度のトレードオフ）
- `leaf_size` (int, default=1): リーフノードの最小サイズ
- `verbose` (int, default=1): 出力詳細度（0:無音、1:通常、2:詳細）
- `seed` (int, default=-1): 乱数シード（-1で自動）

### 検索パラメータ

インデックス作成後、以下のパラメータで検索動作を調整できます：

```python
# 検索時に使用する木の数を調整
index.ntrees = 5            # 構築した木のうち5本を使用

# 候補点数の調整
index.odd_candidates = 11   # 葉ノードのサイズが奇数の場合の候補数
index.even_candidates = 10  # 葉ノードのサイズが偶数の場合の候補数
index.dist_candidates = 100 # 距離計算を行う候補点数

# 近傍探索範囲
index.hops = 1  # 候補点周辺の探索範囲
```

## 制限事項

- 384次元のデータで動作確認済み
- インデックスファイルは指定されたディレクトリに保存されます

## ライセンス

本プロジェクトはSISAP Challenge 2025への参加作品として開発されています。
正式なライセンスはコンテスト終了後に検討予定です。
学術研究や実験目的でのコードの利用を歓迎する方向で検討したいと思っていますので、今しばらくお待ちください。

ライセンスに関するご意見・ご助言は[GitHubのIssue](https://github.com/colun/hforest/issues)にてお寄せください。

## 貢献

**注意**: ライセンス決定までの間、プルリクエストは受け付けておりません。
この期間中に作成されたプルリクエストは内容に関わらずクローズさせていただきます。
長いコードが貼り付けられたIssueに関しても、同様の扱いになる場合があります。

また、関連して、バグ報告・機能提案についても現在は受け付けておりません。
コンテストが終了してライセンス決定後に、[GitHubのIssue](https://github.com/colun/hforest/issues)にてバグ報告や機能提案を受け付ける予定なので、それまでお待ちください。